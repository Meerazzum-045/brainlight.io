<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <style>
        body {
            background-color: hsl(25, 100%, 49%);
            margin: 0;
            height: 100%;
            overflow: hidden;
            touch-action: none; /* Prevent zoom and pan */
        }
        .lottie-animation {
            position: absolute;
            width: 150px;
            height: 150px;
            transform: translate(-50%, -50%);
            pointer-events: none; /* Prevent animations from capturing touch events */
        }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.7.6/lottie.min.js"></script>
</head>

<body>

<script>
    var colors = ["#284B63", "#FF0080", "#76605E", "#FDFD96", "#355b41"];
    var colorIndex = 0;

    function shuffleColors(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }
    shuffleColors(colors);

    function getNextColor() {
        const color = colors[colorIndex];
        colorIndex = (colorIndex + 1) % colors.length;
        var r = parseInt(color.slice(1, 3), 16) / 255;
        var g = parseInt(color.slice(3, 5), 16) / 255;
        var b = parseInt(color.slice(5, 7), 16) / 255;
        return [r, g, b, 1];
    }

    var touchAnimations = {};

    function createAnimation(animationData) {
        if (Object.keys(touchAnimations).length >= 5) return; // Limit to 5 touches

        var animationDataCopy = JSON.parse(JSON.stringify(animationData));

        var uniqueColor = getNextColor();

        // Update colors in animationDataCopy
        animationDataCopy.layers[0].shapes[0].it[2].c.k = uniqueColor; // Fill color
        animationDataCopy.layers[0].shapes[0].it[1].c.k = uniqueColor; // Stroke color

        animationDataCopy.layers[0].shapes[1].it[2].c.k = uniqueColor; // Fill color
        animationDataCopy.layers[0].shapes[1].it[1].c.k = uniqueColor; // Stroke color

        animationDataCopy.layers[0].shapes[2].it[2].c.k = uniqueColor; // Fill color
        animationDataCopy.layers[0].shapes[2].it[1].c.k = uniqueColor; // Stroke color

        var container = document.createElement('div');
        container.className = 'lottie-animation';
        container.style.left = '50%'; // Initial position
        container.style.top = '50%'; // Initial position
        document.body.appendChild(container);

        var params = {
            container: container,
            renderer: 'svg',
            loop: false, // Only play once
            autoplay: true,
            animationData: animationDataCopy // Pass the modified animationDataCopy
        };

        var anim = lottie.loadAnimation(params);
        touchAnimations[animationData.ip] = { container: container, animation: anim };
    }

    function updateAnimationPosition(id, x, y) {
        if (touchAnimations[id]) {
            var container = touchAnimations[id].container;
            container.style.left = x + 'px'; // Update position
            container.style.top = y + 'px'; // Update position
        }
    }

    function removeAnimation(id) {
        if (touchAnimations[id]) {
            var container = touchAnimations[id].container;
            var anim = touchAnimations[id].animation;
            anim.destroy(); // Destroy the animation instance
            document.body.removeChild(container); // Remove the container
            delete touchAnimations[id];
        }
    }

    document.addEventListener('touchstart', function(event) {
        event.preventDefault(); // Prevent scrolling and zooming
        var touches = event.touches;
        for (var i = 0; i < touches.length; i++) {
            if (!touchAnimations[touches[i].identifier]) {
                // Fetch animation data from URL
                fetch('https://raw.githubusercontent.com/Meerazzum-045/brainlight.io/main/file.json')
                    .then(response => response.json()) // Parse response as JSON
                    .then(animationData => {
                        createAnimation(animationData); // Create animation with fetched data
                    })
                    .catch(error => {
                        console.error('Error fetching animation data:', error);
                    });
            }
        }
    });

    document.addEventListener('touchmove', function(event) {
        event.preventDefault(); // Prevent scrolling and zooming
        var touches = event.touches;
        for (var i = 0; i < touches.length; i++) {
            updateAnimationPosition(touches[i].identifier, touches[i].clientX, touches[i].clientY);
        }
    });

    document.addEventListener('touchend', function(event) {
        event.preventDefault(); // Prevent scrolling and zooming
        var touches = event.changedTouches;
        for (var i = 0; i < touches.length; i++) {
            removeAnimation(touches[i].identifier);
        }
    });

    document.addEventListener('touchcancel', function(event) {
        event.preventDefault(); // Prevent scrolling and zooming
        var touches = event.changedTouches;
        for (var i = 0; i < touches.length; i++) {
            removeAnimation(touches[i].identifier);
        }
    });
</script>

</body>

</html>
